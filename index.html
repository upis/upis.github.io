  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>UpIs - enables you to quickly create GitLab and GitHub issues.</title>
      <link rel="stylesheet" href="nm/gaintime/css/gaintime.min.css" media ="screen" title="no title">
      <link rel="stylesheet" href="assets/css/style.css" media ="screen" title="no title">
      <meta name="description" content="Upis enables you to quickly create GitLab and GitHub issues. Submit multiple issues to your git project! It's so easy...">
    </head>
    <body>
      <section class="text-center">
        <div class="medium center">
          <div class="text-right">
            <!-- Place this tag where you want the button to render. -->
            <a class="github-button" href="https://github.com/upis/upis.github.io" data-icon="octicon-star" data-size="large" aria-label="Star upis/upis.github.io on GitHub">Star</a>
            <!-- Place this tag where you want the button to render. -->
            <a class="github-button" href="https://github.com/upis/upis.github.io/fork" data-icon="octicon-repo-forked" data-size="large" aria-label="Fork upis/upis.github.io on GitHub">Fork</a>
            <!-- Place this tag where you want the button to render. -->
            <a class="github-button" href="https://github.com/jprodrigues70" data-size="large" aria-label="Follow @jprodrigues70 on GitHub">Follow @jprodrigues70</a>
          </div>
          <h1>Submit multiple issues to your GitLab or GitHub project</h1>
          <p>You will need use our markup style but it's so easy...
            Well... you will use "- " for issue title, "> " for issue description and "# " for issue labels (multiple labels will be separated by comma). Eg:</p>
            <div class="code-block cmd text-left">
              <h2>- As user i want to login on system</h2>
              <p>> The user will login with email and password</p>
              <p><b># user,essential</b> </p>
            </div>
            <div class="inform warning">
              <p>The space after the character (-, # or >) is fundamental!! Don't forget!</p>
            </div>
            <div class="inform info">
              <p>We do not store any of your data! If you want, check the code.</p>
            </div>
        </div>
      </section>
      <section>
        <div id="loader" class="la-ball-grid-beat la-dark center la-2x mt-50 hidden">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>
        <div class="gt-form center medium">
          <label for="platform">Platform</label>
          <select class="" name="platform" id="platform">
            <option selected value="gitlab">GitLab</option>
            <option value="github">GitHub</option>
          </select>
          <label for="project-url">
            Project URL
            <small>organization/repo</small>
          </label>
          <input id="project-url" type="text" name="project-url" value="">
          <label for="private-token">
            API TOKEN
            (<a id="platform-link" href="https://gitlab.com/profile/personal_access_tokens">Generate Token for <span id="platform-name">GitLab</span></a> or <a href="https://github.com/settings/tokens">Generate Token for GitHub</a>)
          </label>
          <input id="private-token" type="text" name="" value="">
          <label for="content">CONTENT</label>
          <textarea id="content" name="name" rows="22" cols="80"></textarea>
          <button class="btn success full" type="button" name="button" id="generate">submit</button>
        </div>
      </section>
      <footer class="dark">
        <div class="flex-box row center medium">
          <div class="xs-12 sm-4">
            <h2>Upis</h2>
            <p>Designed and built by <a href="https://github.com/jprodrigues70" target="_blank">@jprodrigues70</a></p>
          </div>
          <div class="xs-12 sm-4">
            <h2>Contribute</h2>
            <p><a href="https://github.com/upis/upis.github.io" target="_blank">GitHub</a>!</p>
          </div>
          <div class="xs-12 sm-4">
            <p>This website is made with <a href="https://gaintime.github.io">GainTime Framework</a>.</p>
            <p>This project is licensed under the <a href="https://choosealicense.com/licenses/gpl-3.0/">GNU General Public License v3.0.</a></p>
          </div>
        </div>
      </footer>
      <script type="text/javascript" src="nm/gaintime/js/gaintime.min.js"></script>
      <script src="assets/js/gt-helper.js" charset="utf-8"></script>
      <script src="assets/js/restful.js" charset="utf-8"></script>
      <script type="text/javascript">
        gt("#generate").addEventListener("click", function() {
          var project = gt("#project-url").value;
          var token = gt("#private-token").value;
          var issues = gt("#content").value.split("- ");
          var url = ""
          mountAndSend(issues, 0);

          function toGitLab(project, issue, coment, labels) {
            url = "https://gitlab.com/api/v4/projects/"
            project = project.replace("/", "%2F")
            return {
              "id": project,
              "title": issue,
              "description": coment,
              "labels": labels
            };
          }

          function toGitHub(issue, coment, labels) {
            url = "https://api.github.com/repos/";
            token = null;
            labels = (labels)? labels.split(",") : [];
            return {
              "title": issue,
              "body": coment,
              "labels": labels,
              "access_token": gt("#private-token").value
            }
          }

          function mountAndSend(issues, i) {
            if (i < issues.length) {
              var issue = issues[i];
              if (issue && issue != "" && issue != "%0A") {
                var content = issue.split("> ")
                var issue = content[0]
                var coment = null;
                var labels = null;
                if (content[1]) {
                  var subcontent = content[1];
                  var finish = subcontent.split("# ");
                  var coment = finish[0];
                  if (finish[1]) labels = finish[1].trim();
                } else {
                  content = issue.split("# ");
                  issue = content[0];
                  if (content[1]) labels = content[1].trim();
                }
                if (!coment) coment = "";
                if (!labels) labels = "";


                if (encodeURIComponent(issue)!="%0A") {
                  var dt = (gt("#platform").value == "gitlab")? toGitLab(project, issue, coment, labels) : toGitHub(issue, coment, labels)
                  console.log(dt)
                  if (gt("#platform").value == "gitlab") project = project.replace("/", "%2F")
                  _post(
                    url + project + "/issues",
                    dt,
                    function(data) {
                      mountAndSend(issues, i + 1)
                    },
                    function(data) { console.error(data) },
                    token
                  )
                } else {
                  mountAndSend(issues, i + 1)
                }
              } else {
                mountAndSend(issues, i + 1)
              }

            }
          }

        })
      </script>
      <!-- Place this tag in your head or just before your close body tag. -->
      <script async defer src="https://buttons.github.io/buttons.js"></script>
    </body>
  </html>
